{% extends "layout.html" %}
{% block title %} {{ _('Equipment Details') }} {% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/equipment.css') }}" />
{% endblock %}

{% block content %}

<!-- Header -->
{% include 'partials/header.html' %}

<div class="equipment-container-wrapper">
  <div class="equipment-grid" id="equipment-list">
    <!-- Buraya dinamik veriler gelecek -->
  </div>
</div>

<script>
    document.addEventListener("DOMContentLoaded", function() {
        let equipmentList = document.getElementById("equipment-list");
    
        // **SessionStorage'dan ekipmanları çek**
        let equipmentData = JSON.parse(sessionStorage.getItem("equipment_data")) || [];
    
        if (equipmentData.length === 0) {
            console.warn("{{ _('No equipment data found')}}");
            equipmentList.innerHTML = "<p style='color: red;'>{{ _('No equipment data found')}}</p>";
            return;
        }
    
        console.log("Equipment Listesi Yükleniyor...", equipmentData);
    
        equipmentData.forEach(equipment => {
            let statusClass = equipment.status === "A" ? "green" : "red";
            let equipmentBox = document.createElement("div");
            equipmentBox.className = `equipment-box ${statusClass}`;
           // equipmentBox.innerHTML = `${equipment.model_name}`;
            equipmentBox.innerHTML = `${equipment.equipment_model_name || 'Model Yok'}`;

            equipmentBox.addEventListener("click", function() {
                console.log(`Seçilen Equipment ID: ${equipment.id}`);
    
                sessionStorage.setItem("selected_equipment_id", equipment.id);
    
                fetch("/set_selected_equipment", {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ equipment_id: equipment.id })
                }).then(() => {
                    window.location.href = "/equipment-details";
                });
            });
    
            equipmentList.appendChild(equipmentBox);
        });
    });
    
    
</script>

{% endblock %}
