{% extends "layout.html" %}
{% block title %} {{ _('Equipment Setting')}} {% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/equipment-setting.css') }}" />
{% endblock %}

{% block content %}

<!-- Header -->
{% include 'partials/header.html' %}

<div class="equipment-container">
  <div class="equipment-grid" id="equipment-list">
    <!-- Buraya dinamik veriler gelecek -->
  </div>
</div>

<script>
  document.addEventListener("DOMContentLoaded", function() {
    let equipmentList = document.getElementById("equipment-list");

    // SessionStorage'dan verileri al
    let modbusData = JSON.parse(sessionStorage.getItem("modbus_data")) || [];

    if (modbusData.length === 0) {
      equipmentList.innerHTML = "<p style='color: red;'>{{ _('Modbus data could not be retrieved')}}</p>";
      return;
    }

    // Dinamik olarak cihazları oluştur
    modbusData.forEach(device => {
      let statusClass = device.slave_id ? "green" : "red"; 
      let equipmentBox = document.createElement("div");
      equipmentBox.className = `equipment-box ${statusClass}`;
      equipmentBox.innerHTML = `${device.model_name}<br>{{ _('Slave ID') }}: ${device.slave_id}`;
      equipmentList.appendChild(equipmentBox);
    });
  });
</script>

{% endblock %}
