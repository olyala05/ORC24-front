{% extends "layout.html" %} 

{% block title %} ORC Status - Error Log {% endblock%}

 {% block extra_css %}

<!-- CSS logs -->
<link rel="stylesheet" href="{{ url_for('static', filename='css/log.css') }}" />

<!-- CSS daterangepicker -->
<link rel="stylesheet" href="{{ url_for('static', filename='daterangepicker/daterangepicker.min.css') }}"/>

{% endblock %}

{% block content %}
<!-- Header -->
{% include 'partials/header.html' %}

<div class="log-wrapper">

<div class="daterange-container">
  <div class="custom-daterange">
    <input type="text" name="daterange" id="daterange" class="form-control" readonly />
    
    <!-- SVG'ler input'un içinde -->
    <img class="arrow-icon arrow-down" src="{{ url_for('static', filename='images/svg/down-arrow.svg') }}" alt="Down" width="16" height="16" />
    <img class="arrow-icon arrow-up" src="{{ url_for('static', filename='images/svg/up-arrow.svg') }}" alt="Up" width="16" height="16" />

  </div>
</div>


  <table class="custom-table">
    <thead>
      <tr>
        <th class="archive-col">Arşiv</th>
        <th>Son</th>
        <th>Son Bağlantı Tarihi</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td class="archive-col">
          <span class="status-green status-dot"></span>
        </td>
        <td>Ekipman Karşılaştırması Başarılı</td>
        <td>2024-04-03 13:54:31</td>
      </tr>
      <tr>
        <td class="archive-col">
          <span class="status-green status-dot"></span>
        </td>
        <td>Modem Task Döngüsü Bitti</td>
        <td>2024-04-03 13:54:31</td>
      </tr>
      <tr>
        <td class="archive-col">
          <span class="status-green status-dot"></span>
        </td>
        <td>Equipment Data Collecting Task Döngüsü Başladı</td>
        <td>2024-04-03 13:55:00</td>
      </tr>
      <tr>
        <td class="archive-col">
          <span class="status-green status-dot"></span>
        </td>
        <td>Registerlar Okunuyor</td>
        <td>2024-04-03 13:55:14</td>
      </tr>
      <tr>
        <td class="archive-col">
          <span class="status-green status-dot"></span>
        </td>
        <td>Modbus Bağlantısı Kuruluyor</td>
        <td>2024-04-03 13:55:14</td>
      </tr>
      <tr>
        <td class="archive-col">
          <span class="status-green status-dot"></span>
        </td>
        <td>Register Okundu</td>
        <td>2024-04-03 13:55:14</td>
      </tr>
      <tr>
        <td class="archive-col">
          <span class="status-green status-dot"></span>
        </td>
        <td>Equipment Data Collecting Task Döngüsü Bitti</td>
        <td>2024-04-03 13:55:16</td>
      </tr>
      <tr>
        <td class="archive-col">
          <span class="status-green status-dot"></span>
        </td>
        <td>Modem Task Döngüsü Başladı!</td>
        <td>2024-04-03 13:55:31</td>
      </tr>
      <tr>
        <td class="archive-col">
          <span class="status-green status-dot"></span>
        </td>
        <td>Data Transfer Task Döngüsü Başladı</td>
        <td>2024-04-03 13:55:32</td>
      </tr>
      <tr>
        <td class="archive-col"><span class="status-red status-dot"></span></td>
        <td>Data Transfer Task Döngüsü Bitti</td>
        <td>2024-04-03 13:55:32</td>
      </tr>
      <tr>
        <td class="archive-col">
          <span class="status-green status-dot"></span>
        </td>
        <td>Modem Task Döngüsü Başladı!</td>
        <td>2024-04-03 13:55:31</td>
      </tr>
    </tbody>
  </table>
</div>
<!-- Daterangepicker JS -->
<script src="{{ url_for('static', filename='daterangepicker/moment.min.js') }}"></script>
<script src="{{ url_for('static', filename='daterangepicker/daterangepicker.js') }}"></script>

<script>
$(function () {
  const $input = $('#daterange');
  const $container = $('.custom-daterange');
  const $arrowUp = $('.arrow-up');
  const $arrowDown = $('.arrow-down');
  let isOpen = false; // Takvim açık mı kontrolü

  $arrowUp.show();
  $arrowDown.hide();

  // Takvim başlatılıyor
  $input.daterangepicker({
    singleDatePicker: true,
    showWeekNumbers: true,
    showISOWeekNumbers: true,
    autoApply: true,
    alwaysShowCalendars: true,
    drops: "down",
    opens: "center",
    startDate: "04/05/2025",
    endDate: "04/11/2025",
    ranges: {
      Today: [moment(), moment()],
      Yesterday: [moment().subtract(1, 'days'), moment().subtract(1, 'days')],
      "Last 7 Days": [moment().subtract(6, 'days'), moment()],
      "Last 30 Days": [moment().subtract(29, 'days'), moment()],
      "This Month": [moment().startOf('month'), moment().endOf('month')]
    }
  });

  // Takvim açma/kapatma
  $arrowUp.on('click', function () {
    $input.trigger('click'); // Takvimi açar
    $arrowUp.hide();
    $arrowDown.show();
    isOpen = true;
  });

  $arrowDown.on('click', function () {
    // Takvimi kapatmak için input'un dışına tıklama tetiklenemez, bu yüzden manuel kapatma işlemi yapılmalı
    $('.daterangepicker').hide(); // Takvimi kapat
    $arrowDown.hide();
    $arrowUp.show();
    isOpen = false;
  });

  // Eğer dışarı tıklanırsa ikonları sıfırla
  $(document).on('click', function (e) {
    if (!$(e.target).closest('.daterangepicker, #daterange, .arrow-down, .arrow-up').length) {
      if (isOpen) {
        $arrowDown.hide();
        $arrowUp.show();
        isOpen = false;
      }
    }
  });
});

</script>


<style>
.form-control {
    background: #0B1734;
    color: #fff;
    border: none;
}
.daterange-container {
  margin-bottom: 16px;
  background: #0b1734;
  width: 50%;
  padding: 14px;
  border-radius: 10px;
  border-color: #fcfcfc;
}
</style>
{% endblock %}
