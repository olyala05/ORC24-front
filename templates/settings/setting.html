{% extends "layout.html" %} 

{% block title %} Equipment Details {% endblock %}

{% block content %}
<!-- Header -->
{% include 'partials/header.html' %}

<!-- Orta Kƒ±sƒ±m -->
<div class="test-container">
    <button class="test-btn">Switch to Test Mode</button>
</div>

<!-- Modal -->
<div id="test-modal" class="modal">
    <div class="modal-content">
        <span class="close">&times;</span>
        <div class="modal-icon">‚ö†Ô∏è</div>
        <p>If you switch to test mode, services will shut down.<br>
            Do you want to switch to test mode?</p>
        <div class="modal-buttons">
            <button id="yes-btn">Yes</button>
            <button id="no-btn">No</button>
        </div>
    </div>
</div>

<!-- Yeni ƒ∞√ßerik (ƒ∞lk ba≈üta gizli olacak) -->
<div id="test-mode-content" class="hidden">
    <div class="sidebar">
        <button class="tab-btn" data-target="wifi">Wi-fi Settings</button>
        <button class="tab-btn" data-target="equipment">LoRa Settings</button>
        <button class="tab-btn" data-target="cloud">Ethernet Settings</button>
        <button class="tab-btn" data-target="read">GSM Settingsead</button>
        <button class="tab-btn" data-target="write">ORC Settings</button>
    </div>

    <div class="content-area">
      <!-- Wi-Fi -->
      <div id="wifi" class="tab-content">
          <div class="wifi-container">
              <!-- Available Wi-Fi -->
              <div class="network-box">
                  <button class="network-header wifi-header">
                      Available Wi-Fi 
                      <span class="wifi-icon">
                          <img src="{{ url_for('static', filename='images/svg/12.svg') }}" alt="No Wi-Fi">
                      </span> 
                  </button>
                  <div class="network-info">
                      <!-- Wi-Fi List Here -->
                  </div>
              </div>
  
              <!-- Wi-Fi Password Form -->
              <div class="wifi-connection">
                  <div class="wifi-card">
                      <h4>Wi-Fi Password</h4>
                      <p>Wi-Fi SSID: pier mi 5g</p>
                      <label>Password:</label>
                      <input type="password" placeholder="Enter password">
                      <div class="show-password">
                          <input type="checkbox" id="showPass">
                          <label for="showPass">Show Password</label>
                      </div>
                      <div class="btn-group">
                          <button class="btn cancel">Cancel</button>
                          <button class="btn connect">Connect</button>
                      </div>
                  </div>
  
                  <!-- Connected Wi-Fi -->
                  <div class="wifi-card connected">
                      <h4>Connected</h4>
                      <div class="underline"></div>
                      <div class="wifi-info">
                        <img src="{{ url_for('static', filename='images/svg/12.svg') }}" alt="No Wi-Fi">
                          <span>Pier Enerji</span>
                          <button class="btn disconnect">Disconnect</button>
                      </div>
                  </div>
              </div>
          </div>
      </div>
  </div>
  
        
<!-- Equipment -->
<div id="equipment" class="tab-content">

            <!-- Equipment Table Container -->
            <div class="eq-table-wrap">
                <table class="eq-table">
                    <thead>
                        <tr>
                            <th>Serial Number</th>
                            <th>SID/IP</th>
                            <th>Status / Configuration</th>
                            <th>Connection</th>
                            <th>Connection Protocol</th>
                            <th>Equipment Date / Connection Date</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>EMR-53CS@3630748023</td>
                            <td>5</td>
                            <td class="eq-status-ok">A / A</td>
                            <td class="eq-connection-ok">OK</td>
                            <td>Modbus</td>
                            <td>2024-04-01 10:43:19</td>
                        </tr>
                        <tr>
                            <td>MPR-46S@2931</td>
                            <td>192.168.1.147</td>
                            <td class="eq-status-ok">A / A</td>
                            <td class="eq-connection-ok">OK</td>
                            <td>TCP / IP</td>
                            <td>2024-04-01 10:43:19</td>
                        </tr>
                        <tr>
                            <td>EMR-53CS@3630748023</td>
                            <td>5</td>
                            <td class="eq-status-ok">A / A</td>
                            <td class="eq-connection-ok">OK</td>
                            <td>Modbus</td>
                            <td>2024-04-01 10:43:19</td>
                        </tr>
                    </tbody>
                </table>
            </div>

                <!-- Butonlar ve Baƒülantƒ± Durumu Yan Yana -->
        <div class="eq-btn-group">
            <!-- K√º√ß√ºk tarama butonu -->
            <button class="eq-scan-btn">Scan Test</button>
        
            <!-- Durum mesajlarƒ± saƒüda olacak -->
            <div class="eq-conn-status">
                <p class="eq-status-success">‚úî Local Network Connection Scan Successful.</p>
                <p class="eq-status-fail">‚úñ Local Network Connection Scan Failed.</p>
            </div>
        </div>
        <!-- B√ºy√ºk g√ºncelleme butonu -->
        <button class="eq-update-btn">Update the equipment table with the equipment found during scanning</button>

        </div>
            <!-- Cloud Connection Test -->
            <div id="cloud" class="tab-content">

                <!-- Cloud Connection Table -->
                <div class="cloud-table-wrap">
                    <table class="cloud-table">
                        <thead>
                            <tr>
                                <th>Archive</th>
                                <th>End</th>
                                <th>Service</th>
                                <th>Date</th>
                                <th>Time</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td class="cloud-status"><span class="dot green"></span></td>
                                <td class="cloud-status"><span class="dot green"></span></td>
                                <td>Cloud connection</td>
                                <td>2024-04-03</td>
                                <td>13:55:00</td>
                            </tr>
                            <tr>
                                <td class="cloud-status"><span class="dot green"></span></td>
                                <td class="cloud-status"><span class="dot green"></span></td>
                                <td>Rabbit Mq</td>
                                <td>2024-04-03</td>
                                <td>13:55:11</td>
                            </tr>
                            <tr>
                                <td class="cloud-status"><span class="dot green"></span></td>
                                <td class="cloud-status"><span class="dot green"></span></td>
                                <td>VPN Port</td>
                                <td>2024-04-03</td>
                                <td>13:55:14</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- Description -->
                <p class="cloud-note">
                    *Does the ORC have connection with cloud and other devices or not?
                </p>

                <!-- Buttons and Status Messages -->
                <div class="cloud-btn-group">
                    <button class="cloud-scan-btn">Perform a scanning test</button>

                    <div class="cloud-status-messages">
                        <p class="cloud-status-success">‚úî Local Network Connection Scan Successful.</p>
                        <p class="cloud-status-fail">‚úñ Local Network Connection Scan Failed.</p>
                    </div>
                </div>
            </div>


            <!-- Read Section -->
            <div id="read" class="tab-content">
                <!-- Form for Backend -->
                <form action="/read-data" method="POST" class="read-form">
                    <div class="read-input-group">
                        <label for="port">Port</label>
                        <input type="text" id="port" name="port" value="/dev/ttyUSB0">
                    </div>
                    <div class="read-input-group">
                        <label for="baudrate">Baud Rate</label>
                        <input type="text" id="baudrate" name="baudrate" value="9600">
                    </div>
                    <div class="read-input-group">
                        <label for="parity">Parity</label>
                        <input type="text" id="parity" name="parity" value="None">
                    </div>
                    <div class="read-input-group">
                        <label for="stopbit">Stop Bit</label>
                        <input type="text" id="stopbit" name="stopbit" value="8">
                    </div>
                    <div class="read-input-group">
                        <label for="register">Register</label>
                        <input type="text" id="register" name="register" value="8">
                    </div>
                    <div class="read-input-group">
                        <label for="count">Count</label>
                        <input type="text" id="count" name="count" value="8">
                    </div>
                    <div class="read-input-group">
                        <label for="datatype">Data Type</label>
                        <input type="text" id="datatype" name="datatype" value="uint32">
                    </div>

                    <!-- Buttons and Status Messages -->
                    <div class="read-btn-group">
                        <button type="submit" class="read-scan-btn">Perform a scanning test</button>

                        <div class="read-status-messages">
                            <p class="read-status-success">‚úî Local Network Connection Scan Successful.</p>
                            <p class="read-status-fail">‚úñ Local Network Connection Scan Failed.</p>
                        </div>
                    </div>

                    <!-- Terminal -->
                    <div class="read-terminal">
                        <label class="terminal-label">Terminal</label>
                        <textarea readonly>/dev/ttyUSB0</textarea>
                    </div>
                </form>
            </div>

             <!-- Write Section -->
            <div id="write" class="tab-content">
                <!-- Form for Backend -->
                <form action="/write-data" method="POST" class="wr-form">
                    <div class="wr-input-group">
                        <label for="port">Port</label>
                        <input type="text" id="port" name="port" value="/dev/ttyUSB0">
                    </div>
                    <div class="wr-input-group">
                        <label for="baudrate">Baud Rate</label>
                        <input type="text" id="baudrate" name="baudrate" value="9600">
                    </div>
                    <div class="wr-input-group">
                        <label for="parity">Parity</label>
                        <input type="text" id="parity" name="parity" value="None">
                    </div>
                    <div class="wr-input-group">
                        <label for="stopbit">Stop Bit</label>
                        <input type="text" id="stopbit" name="stopbit" value="8">
                    </div>
                    <div class="wr-input-group">
                        <label for="register">Register</label>
                        <input type="text" id="register" name="register" value="8">
                    </div>
                    <div class="wr-input-group">
                        <label for="count">Count</label>
                        <input type="text" id="count" name="count" value="8">
                    </div>
                    <div class="wr-input-group">
                        <label for="datatype">Data Type</label>
                        <input type="text" id="datatype" name="datatype" value="uint32">
                    </div>

                    <!-- Buttons and Status Messages -->
                    <div class="wr-btn-group">
                        <button type="submit" class="wr-scan-btn">Perform a scanning test</button>

                        <div class="wr-status-messages">
                            <p class="wr-status-success">‚úî Local Network Connection Scan Successful.</p>
                            <p class="wr-status-fail">‚úñ Local Network Connection Scan Failed.</p>
                        </div>
                    </div>

                    <!-- Terminal -->
                    <div class="wr-terminal">
                        <label class="terminal-label">Terminal</label>
                        <textarea readonly>Write successful

            Read value: sadfasd</textarea>
                    </div>
                </form>
            </div>

    </div>
</div>

<script>
    document.addEventListener("DOMContentLoaded", function () {
        var btn = document.querySelector(".test-btn");
        var modal = document.getElementById("test-modal");
        var closeBtn = document.querySelector(".close");
        var noBtn = document.getElementById("no-btn");
        var yesBtn = document.getElementById("yes-btn");
        var testModeContent = document.getElementById("test-mode-content");
        var testContainer = document.querySelector(".test-container");
        var tabButtons = document.querySelectorAll(".tab-btn");
        var tabContents = document.querySelectorAll(".tab-content");

        // üéØ 1Ô∏è‚É£ Sayfa y√ºklendiƒüinde test modunu kontrol et
        if (localStorage.getItem("testMode") === "enabled") {
            testContainer.style.display = "none";  // ƒ∞lk butonu gizle
            testModeContent.style.display = "flex";  // Yeni butonlarƒ± g√∂ster
            modal.style.display = "none";  // Modal kapalƒ± ba≈ülasƒ±n
        } else {
            testContainer.style.display = "flex";  // ƒ∞lk butonu g√∂ster
            testModeContent.style.display = "none";  // Yeni i√ßerikleri gizle
        }

        // üéØ 2Ô∏è‚É£ "Switch to Test Mode" butonuna tƒ±klanƒ±nca modal a√ßƒ±lsƒ±n
        btn.addEventListener("click", function () {
            if (!localStorage.getItem("testMode")) {
                modal.style.display = "flex"; // Modalƒ± a√ß
            }
        });

        // üéØ 3Ô∏è‚É£ "X" veya "No" butonuna tƒ±klanƒ±nca modal kapansƒ±n
        closeBtn.addEventListener("click", function () {
            modal.style.display = "none";
        });
        noBtn.addEventListener("click", function () {
            modal.style.display = "none";
        });

        // üéØ 4Ô∏è‚É£ "Yes" butonuna tƒ±klanƒ±nca test modu aktif edilsin
        yesBtn.addEventListener("click", function () {
            modal.style.display = "none";  // Modal kapat
            testContainer.style.display = "none";  // ƒ∞lk butonu gizle
            testModeContent.style.display = "flex";  // Yeni i√ßeriƒüi g√∂ster
            localStorage.setItem("testMode", "enabled");  // Test modunu localStorage'a kaydet
        });

        // üéØ 5Ô∏è‚É£ Tab butonlarƒ±na tƒ±klanƒ±nca ilgili i√ßeriƒüi g√∂ster
        tabButtons.forEach(button => {
            button.addEventListener("click", function () {
                var target = this.getAttribute("data-target");

                // T√ºm i√ßerikleri gizle
                tabContents.forEach(content => {
                    content.style.display = "none";
                });

                // Se√ßili i√ßeriƒüi g√∂ster
                document.getElementById(target).style.display = "block";

                // √ñnce t√ºm butonlardan aktif class'ƒ±nƒ± kaldƒ±r
                tabButtons.forEach(btn => btn.classList.remove("active"));

                // ≈ûu an tƒ±klanan butona aktif class'ƒ± ekle
                this.classList.add("active");

                // Son a√ßƒ±lan sekmeyi kaydet
                localStorage.setItem("lastTab", target);
            });
        });

        // üéØ 6Ô∏è‚É£ Sayfa yenilendiƒüinde en son a√ßƒ±lan sekmeyi g√∂ster
        var lastTab = localStorage.getItem("lastTab");
        if (lastTab) {
            document.getElementById(lastTab).style.display = "block";
            tabButtons.forEach(button => {
                if (button.getAttribute("data-target") === lastTab) {
                    button.classList.add("active");
                }
            });
        } else {
            tabContents.forEach(content => content.style.display = "none");
        }
    });
</script>

<style>
  .wifi-container {
    display: flex;
    gap: 20px;
    align-items: flex-start;
}

.network-box {
    .network-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        font-size: 16px;
        font-weight: bold;
        background: #f5f5f5;
        padding: 10px;
        border-radius: 5px;
        border: none;
        cursor: pointer;

        .wifi-icon img {
            width: 20px;
        }
    }
}

.wifi-connection {
    display: flex;
    flex-direction: column;
    gap: 15px;
}

.wifi-card {
    background: white;
    padding: 5px;
    border-radius: 10px;
    width: 350px;

    h4 {
        font-size: 18px;
        margin-bottom: 10px;
        color: #1C2747;
    }

    p {
        font-size: 14px;
        margin-bottom: 10px;
    }

    label {
        font-weight: bold;
        display: block;
        margin-bottom: 5px;
        color: #1C2747;
    }

    input {
        width: 100%;
        padding: 8px;
        border: 1px solid #E2E2E2;
        border-radius: 5px;
        background: #E2E2E2;;
    }

    .show-password {
        display: flex;
        align-items: center;
        gap: 5px;
        margin-top: 5px;
    }

    .btn-group {
      display: flex;
      justify-content: flex-end;
      margin-top: 15px;
      gap: 14px;

        .btn {
            padding: 8px 12px;
            border: none;
            cursor: pointer;
            border-radius: 5px;

            &.cancel {
              background: #EF742A;
              color: white;
              padding: 14px 40px;
            }

            &.connect {
                background: #EF742A;
                color: white;
                padding: 14px 40px;
            }
        }
    }

    &.connected {
        .wifi-info {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 10px;
            border-radius: 5px;
            color: #1C2747;
            font-weight: bold;


            .disconnect {
              background: #EF742A;
              color: white;
              border: none;
              padding: 14px 40px;
              cursor: pointer;
              border-radius: 5px;
            }
        }
    }
}

</style> 
{% endblock %}
