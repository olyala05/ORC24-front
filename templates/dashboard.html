{% extends "layout.html" %} {% block title %} ORC 24 Dashboard {% endblock
title%} {% block content %}

<header class="header">
  <div class="header-left">
    <form action="{{ url_for('logout') }}" method="POST" id="logout-form">
      <button type="button" class="header-button-logout" id="logout-button">
        <img
          src="{{ url_for('static', filename='images/svg/37.svg') }}"
          alt="Logout"
          width="40"
          height="40"
          style="padding: 0px 0px; border-radius: 5px"
        />
      </button>
    </form>

    <!-- Menu butonunu modem-selection sayfasına yönlendirme -->
    <form action="{{ url_for('modem_selection') }}" method="GET">
      <button type="submit" class="header-button" style="gap:0;">
        <img
          src="{{ url_for('static', filename='images/svg/39.svg') }}"
          alt="Logout"
          width="30"
          height="30"
          style="padding: 0px 0px; border-radius: 5px"
        />
        <span style="padding: 14px 13px;">{{ _('Modems') }}</span>
      </button>
    </form>
  </div>

  <div class="header-logo">
    <img
      src="{{ url_for('static', filename='images/logos/logo-02.png') }}"
      alt="Pier MTTP Logo"
      class="logo"
    />
  </div>

  <div class="header-right-dashboard">
    <div class="date-time" id="current-date-time">Loading...</div>
    <div class="report-line">
      <div class="line"></div>
    </div>
    <div class="report-date" id="report-date">
      <span style="color: #6384d1">{{ _('Report Date') }}:</span> Loading...
    </div>
  </div>
</header>

<!-- Ana Tablo -->
<section class="dashboard">
  <div class="energy-table">
    <div class="energy-header">
      <div>{{ _('Energy Drawn From The Grid') }}</div>
      <div style="margin-right: 79px">{{ _('Generated Energy') }}</div>
      <div>{{ _('Consumed Energy') }}</div>
    </div>
    <div class="energy-row">
      <div>
        <img
          src="{{ url_for('static', filename='images/svg/08.svg') }}"
          alt="Energy"
        />
        80.158,68 kWh
      </div>
      <div>
        <img
          src="{{ url_for('static', filename='images/svg/08.svg') }}"
          alt="Energy"
        />
        80.158,68 kWh
      </div>
      <div>
        <img
          src="{{ url_for('static', filename='images/svg/08.svg') }}"
          alt="Energy"
        />
        80.158,68 kWh
      </div>
    </div>

    <div class="energy-row">
      <div>
        <img
          src="{{ url_for('static', filename='images/svg/09.svg') }}"
          alt="Industry"
        />
        80.158,68 TEP
      </div>
      <div>
        <img
          src="{{ url_for('static', filename='images/svg/09.svg') }}"
          alt="Industry"
        />
        80.158,68 TEP
      </div>
      <div>
        <img
          src="{{ url_for('static', filename='images/svg/09.svg') }}"
          alt="Industry"
        />
        80.158,68 TEP
      </div>
    </div>

    <div class="energy-row">
      <div>
        <img
          src="{{ url_for('static', filename='images/svg/10.svg') }}"
          alt="Cloud"
        />
        80.158,68 Ton
      </div>
      <div>
        <img
          src="{{ url_for('static', filename='images/svg/10.svg') }}"
          alt="Cloud"
        />
        80.158,68 Ton
      </div>
      <div>
        <img
          src="{{ url_for('static', filename='images/svg/10.svg') }}"
          alt="Cloud"
        />
        80.158,68 Ton
      </div>
    </div>
  </div>

  <div class="device-status">
    <div class="dashboard-container">
      <!-- Voltaj ve Akım Kutuları -->
      <div class="voltage-section">
        <div class="voltage-table">
          <div class="voltage-box">
            <span class="icon">
              <img src="{{ url_for('static', filename='images/svg/33.svg') }}" alt="Voltage" />
            </span>
            <span class="value">220 V</span>
            <span class="phase">V1-N</span>
          </div>
          <div class="voltage-box">
            <span class="icon">
              <img src="{{ url_for('static', filename='images/svg/33.svg') }}" alt="Voltage" />
            </span>
            <span class="value">220 V</span>
            <span class="phase">V2-N</span>
          </div>
          <div class="voltage-box">
            <span class="icon">
              <img src="{{ url_for('static', filename='images/svg/33.svg') }}" alt="Voltage" />
            </span>
            <span class="value">220 V</span>
            <span class="phase">V3-N</span>
          </div>
        </div>
  
        <div class="voltage-table">
          <div class="voltage-box">
            <span class="icon">
              <img src="{{ url_for('static', filename='images/svg/34.svg') }}" alt="Current" />
            </span>
            <span class="value">300 A</span>
            <span class="phase">I1-N</span>
          </div>
          <div class="voltage-box">
            <span class="icon">
              <img src="{{ url_for('static', filename='images/svg/34.svg') }}" alt="Current" />
            </span>
            <span class="value">250 A</span>
            <span class="phase">I2-N</span>
          </div>
          <div class="voltage-box">
            <span class="icon">
              <img src="{{ url_for('static', filename='images/svg/34.svg') }}" alt="Current" />
            </span>
            <span class="value">220 A</span>
            <span class="phase">I3-N</span>
          </div>
        </div>
      </div>
  
      <!-- Göstergeler -->
      <div class="gauge-container">
        <div class="gauge">
          <div class="gauge-circle frequency">
            <span>50,04</span>
            <p>Frekans</p>
            <p>(Hz)</p>
          </div>
        </div>
  
        <div class="gauge">
          <div class="gauge-border">
            <div class="gauge-circle reactive">
              <span>{{ _('Reaktif Cezada') }}</span>
              <p>{{ _('Değil') }}</p>
            </div>
          </div>
        </div>
  
        <div class="gauge">
          <div class="gauge-circle power-factor">
            <span>{{ _('Güç Faktörü') }}</span>
            <p>%87,45</p>
          </div>
        </div>
      </div>
    </div>
  </div>
  
</section>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    function updateDateTime() {
      const userLang = document.body.dataset.lang || "en"; // HTML'den alınan aktif dil

      const now = new Date();
      const monthShort = now
        .toLocaleString(userLang, { month: "long" })
        .substring(0, 5);
      const formattedDateTime = `${monthShort} ${now.getDate()}, ${now.getFullYear()}, ${now.getHours()}:${now
        .getMinutes()
        .toString()
        .padStart(2, "0")}`;
      document.getElementById("current-date-time").innerText =
        formattedDateTime;

      const lastMonth = new Date();
      lastMonth.setDate(lastMonth.getDate() - 30);

      const reportStartMonth = lastMonth
        .toLocaleString(userLang, { month: "long" })
        .substring(0, 5);
      const reportEndMonth = now
        .toLocaleString(userLang, { month: "long" })
        .substring(0, 5);

      const reportStart = `${reportStartMonth} ${lastMonth.getDate()}`;
      const reportEnd = `${reportEndMonth} ${now.getDate()}`;

      const reportDateEl = document.getElementById("report-date");
      reportDateEl.innerHTML = `<span style="color: #6384D1;">{{ _('Report Date') }}:</span> <span style="color: #fff;">${reportStart} - ${reportEnd}</span>`;
    }

    updateDateTime();
    setInterval(updateDateTime, 60000);
  });

  document.addEventListener("DOMContentLoaded", function () {
    document
      .getElementById("logout-button")
      .addEventListener("click", function (event) {
        event.preventDefault(); 

        // Trigger SweetAlert confirmation with custom styling
        Swal.fire({
          title: "Çıkış yapmak istediğinize emin misiniz?",
          icon: "warning",
          background: "#0B1734",
          iconColor: "#EF8018",
          showCancelButton: true,
          confirmButtonText: "Evet", // Sağda
          cancelButtonText: "Hayır", // Solda
          reverseButtons: false, // Bu zaten varsayılan
          customClass: {
            confirmButton: "swal-button-yes", // Sağdaki buton
            cancelButton: "swal-button-no", // Soldaki buton
          },
          buttonsStyling: false,
        }).then((result) => {
          if (result.isConfirmed) {
            document.getElementById("logout-form").submit();
          }
        });
      });
  });
</script>

<style>
  .swal-button-yes {
    background-color: #fff;
    color: #0b1734;
    border-radius: 5px;
    padding: 17px 19px;
    font-size: 16px;
    border: none;
  }

  .swal-button-no {
    background-color: #fff;
    color: #0b1734;
    border-radius: 5px;
    padding: 17px 19px;
    font-size: 16px;
    border: 2px solid #0b1734;
  }

  .swal2-popup {
    border-radius: 8px;
    box-shadow: 0 2px 15px rgba(0, 0, 0, 0.2);
  }

  /* Ensuring buttons are properly spaced and displayed */
  .swal2-actions {
    display: flex;
    justify-content: space-between; /* Space the buttons properly */
    width: 100%; /* Ensure full width for button spacing */
  }

  .swal2-confirm {
    width: 48%;
    margin-right: 4%;
  }

  .swal2-cancel {
    width: 48%;
  }

  div:where(.swal2-container) h2:where(.swal2-title) {
    position: relative;
    max-width: 100%;
    padding: 1em 1em 1em;
    color: #ffffff;
    font-size: 16px;
    font-weight: 500;
  }

  .swal2-actions {
    display: flex;
    justify-content: space-between;
    width: 94%;
  }

  body.swal2-shown {
    padding-right: 0 !important;
    overflow: hidden !important;
  }
  .header,
  .fixed-element {
    transform: none !important;
    will-change: auto !important;
  }

  div:where(.swal2-container).swal2-backdrop-show,
  div:where(.swal2-container).swal2-noanimation {
    background: rgba(0, 0, 0, 0.4);
  }

  div:where(.swal2-container).swal2-center > .swal2-popup {
    grid-column: 2;
    grid-row: 2;
    place-self: center center;
    margin-top: 64px;
  }
</style>
{% endblock content %}
